%% Simple two-d plot

dataA = linspace(0.1, 0.7, 20);
dataB = -dataA.^2 + dataA + (rand(size(dataA)) - 0.5)/7;
dataC = 1 - dataA - dataB;

A = linspace(0, 1, 100);
B = -A.^2+A;

ternplot(dataA, dataB, dataC, 'r.', 'majors', 5);
hold on
ternplot(A, B)
ternlabel('A', 'B', 'C')
legend('Data', 'Fit')
hold off

%% Simple two-d density plot
num_axes_steps = 5;
num_color_classes = 5;
ternplot_pro(dataA, dataB, dataC, num_axes_steps, num_color_classes);
ternlabel('A', 'B', 'C');
hold on
ternplot(dataA, dataB, dataC, 'r.');
hold off

%% Three D plot for viscosity of HIPS, ABS and PETG polymer blends
experimental = [0,0.0394405471567990,0.0922162236202371,0.157869338049470,0.234261515715478,0.317837893016641,0.404508507182378,0.489741263324283,0.570348502549596,0.643995533336664,0.709562728456967,0.766728731686699,0.815818253904276,0.857547506426920,0.892717226384175,0.922294195883847,0.947056876492250,0.967423885137879,0.984939787586583,0.999782858694414,0,0.0161997864613861,0.0385845953172204,0.0681187421146824,0.105510336321324,0.151044395103406,0.204458112196344,0.264911155169532,0.331041270212879,0.401112339082136,0.473233648205909,0.545654976415449,0.685667118778530,0.751425767443796,0.813710768984938,0.928328424947751,0.981412567437542,0,0.00909349315240894,0.0216589490865170,0.0384221010388070,0.0601339372041284,0.0875221969661021,0.121243673211981,0.161815087981281,0.209588018185704,0.264703591609896,0.327108642957659,0.396588050632280,0.472875899663480,0.555744483008487,0.645201421799806,0.741573075783080,0.845708413270459,0.959255083662674,0,0.00615014452584557,0.0145991418740888,0.0258781957647168,0.0405925410954222,0.0594282910481830,0.0831614070204589,0.112665431488127,0.148928298555839,0.193109912431444,0.311174954805498,0.389156444406799,0.483885542302564,0.745794238187833,0.932884521585845,0,0.00472997740192747,0.0111867273560610,0.0197910649817655,0.0310520544888997,0.0455962268402275,0.0642056696820957,0.0878854533617081,0.117960429319734,0.205415094205012,0.269409475446754,0.354604886373738,0.471856933091414,0.641023078727166,0.901961879513890,0,0.00401105942943939,0.00945651327048869,0.0167024725256581,0.0262154842456432,0.0386045378667111,0.0546892469316920,0.0756222166551941,0.139708187947788,0.189773480663716,0.260892616258438,0.542399852062930,0.866248478084708,0,0.00368291646747206,0.00866320195769559,0.0152918244736117,0.0240364272012625,0.0355433564362194,0.0507477583122535,0.0988040296265353,0.137928899719545,0.195973719670531,0.288917644550168,0.456601427588907,0.825514340210532,0,0.00361995896849471,0.00850622631953247,0.0150271021640271,0.0236989312910743,0.0352785510242957,0.0726358646380449,0.103845444903659,0.151464656151248,0.385762800740060,0.779703700534988,0,0.00378080073319247,0.00888849503224138,0.0157466955205777,0.0249818852812295,0.0551895477073767,0.0808346881912903,0.120644421134929,0.329024924222228,0.728814615327475,0,0.00417568340371928,0.00984035885086022,0.0175280084692707,0.0429215875049333,0.0646823416102649,0.0987975404324246,0.284092431651804,0.673081351909486,0,0.00486124779979085,0.0115119975182677,0.0336491673258929,0.0527099275220442,0.0827049653408234,0.248269124943181,0.612851544908684,0,0.00595397615179581,0.0142139297914395,0.0259022213592786,0.0430959995140567,0.0701183716034476,0.117545584547417,0.218894387759067,0.548678608604451,0,0.0185160920020670,0.0344411880446700,0.0593172203821036,0.193520118122416,0.481234717840659,0,0.0103472394088037,0.0254439459848679,0.0487638227728653,0.0885664550612175,0.169833656864004,0.411428979071758,0,0.0146248274705651,0.0368282001546276,0.145567798355237,0.340243629060739,0,0.0214851441943758,0.0557603752703759,0.118473152648690,0.268723145351556,0,0.0863733502072609,0.197977311368694,0,0.0473376562283178,0.129013845755337,0,0.0627742709835444,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.000260137656885637,0.000544439441097242,0.000952473097776611,0.00149380268642282,0.00217293837858727,0.00298756680854127,0.00392779283163589,0.00497676331375718,0.00611225764380670,0.00730918127707158,0.00854260128065026,0.00979144624195211,0.0122753533456881,0.0134966743565204,0.0147040049314655,0.0171121720894705,0.0183399853346625,0.000591761119543400,0.00106476127184392,0.00171139735388698,0.00255217331817168,0.00360658623028591,0.00489150327402868,0.00642030085394331,0.00820143539647414,0.0102389843845963,0.0125323212854029,0.0150779165743862,0.0178712990359376,0.0209112827109147,0.0242029917545057,0.0277642262826224,0.0316280547873593,0.0358496135299368,0.0405156224119012,0.00102046662909505,0.00166823502243957,0.00252454486697318,0.00361893905033652,0.00498396185422936,0.00665550079195055,0.00867359951799239,0.0110832537374047,0.0139360003878979,0.0172942549506429,0.0258604347485284,0.0313053240008906,0.0377654572865312,0.0550071926367594,0.0668937837552466,0.00159053383996684,0.00243480917925665,0.00352568808855061,0.00490261829178989,0.00661312003194840,0.00871530442064649,0.0112814064250478,0.0144044191334541,0.0182067837522255,0.0285960217980367,0.0357803672486262,0.0449653104756892,0.0570641002244860,0.0736707942045627,0.0978052419815166,0.00237066805472040,0.00346169192328346,0.00485009927629707,0.00658913976060842,0.00874768703799224,0.0114151968029757,0.0147114363038738,0.0188037263069902,0.0304657206894980,0.0389840320986059,0.0504784961222205,0.0915568204250279,0.133527917054817,0.00346729231844732,0.00488892087925847,0.00668142531447748,0.00892003809562576,0.0117067327765400,0.0151816324666709,0.0195453599534711,0.0323054142784458,0.0419560254708549,0.0554634316306711,0.0756532295133464,0.109043195846361,0.174253434765448,0.00504682208434727,0.00693158111850159,0.00929831666051817,0.0122584497288403,0.0159707859440199,0.0206649941221717,0.0346106883007488,0.0453893604851590,0.0608392941435798,0.126966785716099,0.220076012406786,0.00737487395449444,0.00993189324936554,0.0131447542287577,0.0171884146384114,0.0223235352276644,0.0377256724152287,0.0497882382463803,0.0673346410121231,0.146418609293888,0.270946007741039,0.0108840680053458,0.0144490632264752,0.0189522712624939,0.0246861150201195,0.0419739407234837,0.0556097458136753,0.0756135989159954,0.168616413640676,0.326678791537513,0.0162927463429031,0.0214186634274565,0.0279623247251299,0.0477339134709531,0.0633705132277716,0.0863831152763894,0.194871577225066,0.386908623539686,0.0248210265721438,0.0324468631640662,0.0423440035763315,0.0555086806782333,0.0737253948201121,0.100504414118014,0.143821292795893,0.226576473906148,0.451104254897484,0.0385797496426455,0.0659939119569988,0.0875595217890569,0.119093245118812,0.265239834687680,0.518527764774370,0.0612838466983017,0.0801781761451798,0.106088800816843,0.143617642999369,0.203008141485351,0.312443280323988,0.588335979850242,0.0995221728668179,0.131016796606894,0.176041199471674,0.369725132071213,0.659538071914212,0.164784527494724,0.218931882125728,0.300424029289493,0.438394629604044,0.731037176002672,0.275756561528429,0.519250612707384,0.801802432177440,0.456513030240672,0.612191461889700,0.870737951349647,0.716260669522845,0.937008111425536,0.999750017377412];
data = [350.199000000000,348.544000000000,347.202000000001,346.236000000001,345.666000000002,345.483000000002,345.639000000002,346.100000000001,346.781000000001,347.609000000001,348.508000000000,349.412000000000,350.261999999999,351.006999999999,351.606999999998,352.025999999998,352.238999999997,352.233999999997,351.971999999998,351.451999999998,375.659999999998,373.334999999999,371.063999999999,368.898999999999,366.870999999999,365.007000000000,363.325000000000,361.830000000001,360.515000000001,359.362000000001,358.343000000002,357.419000000002,355.690000000003,354.797000000003,353.832000000003,351.534000000003,350.139000000004,394.578000000003,391.912000000004,389.183000000004,386.428000000004,383.664000000005,380.909000000005,378.177000000005,375.481000000006,372.826000000006,370.213000000006,367.636000000006,365.083000000007,362.534000000007,359.964000000007,357.341000000007,354.631000000007,351.797000000007,348.798000000007,408.780000000007,405.866000000007,402.816000000008,399.654000000008,396.389000000008,393.026000000008,389.567000000008,386.013000000009,382.363000000009,378.609000000009,370.735000000009,366.572000000009,362.213000000009,352.715000000009,347.439000000009,419.082000000009,415.960000000010,412.642000000010,409.147000000010,405.473000000010,401.612000000010,397.554000000011,393.283000000011,388.779000000011,378.940000000011,373.508000000011,367.639000000011,361.224000000011,354.110000000011,346.071000000011,425.943000000011,422.631000000012,419.071000000012,415.276000000012,411.230000000012,406.913000000012,402.299000000012,397.350000000012,386.230000000013,379.891000000013,372.857000000013,355.719000000013,344.702000000013,429.676000000013,426.186000000013,422.397000000013,418.312000000013,413.904000000013,409.137000000014,403.961000000014,392.086000000014,385.153000000014,377.301000000014,368.195000000014,357.251000000014,343.342000000014,430.549000000014,426.885000000014,422.869000000015,418.493000000015,413.713000000015,408.472000000015,396.247000000015,388.978000000015,380.616000000015,358.446000000015,341.999000000015,428.817000000015,424.977000000015,420.728000000016,416.046000000016,410.867000000016,398.615000000016,391.220000000016,382.610000000016,359.105000000016,340.683000000016,424.739000000016,420.716000000016,416.220000000016,411.204000000016,399.189000000016,391.845000000016,383.207000000016,359.102000000016,339.401000000016,418.587000000016,414.368000000016,409.599000000017,398.039000000017,390.893000000017,382.419000000017,358.380000000017,338.161000000017,410.639000000017,406.205000000017,401.126000000017,395.282000000017,388.461000000017,380.317000000017,370.237000000017,356.945000000018,336.969000000018,401.185000000018,391.072000000018,384.684000000018,377.015000000018,354.849000000018,335.832000000018,390.526000000018,385.584000000018,379.726000000018,372.661000000018,363.847000000018,352.182000000018,334.752000000018,378.988000000018,373.763000000018,367.420000000018,349.063000000018,333.731000000018,366.965000000018,361.473000000018,354.606000000018,345.628000000018,332.770000000019,354.986000000018,342.019000000018,331.864000000019,343.855000000018,338.376000000018,331.010000000019,334.810000000018,330.197000000018,329.418000000019];

A = experimental(1,:)';
B = experimental(2,:)';
C = 1 - (A + B);

figure
subplot(2, 2, 1)
ternplot(A, B, C, '.'); ternlabel('HIPS', 'ABS', 'PETG');
subplot(2, 2, 2)
ternpcolor(A, B, data); ternlabel('HIPS', 'ABS', 'PETG');
shading interp
subplot(2, 2, 3)
terncontour(A, B, data); ternlabel('HIPS', 'ABS', 'PETG');
subplot(2, 2, 4)
ternsurf(A, B,C, data/329);
axis([0 1 0 1 0 5])
hold off

disp(min(data))
disp(max(data))
figure ()
%ternsurf(A, B,C, data/329);
